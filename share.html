<script>
const db = firebase.database();

// 转 爪专转  砖转砖  拽抓 专砖
let currentUserId = localStorage.getItem("currentUserId");
if (!currentUserId) {
  currentUserId = "user_" + Math.random().toString(36).substr(2, 9);
  localStorage.setItem("currentUserId", currentUserId);
}

// 拽转 -ID 拽
const urlParams = new URLSearchParams(window.location.search);
const shareId = urlParams.get("id");

if (!shareId) {
  document.body.innerHTML = "拽砖专  转拽.";
}

// 转 转 -share
db.ref("shared/" + shareId).once("value").then(snapshot => {
  const data = snapshot.val();

  if (!data) {
    document.body.innerHTML = "转 专 砖转驻  砖拽砖专  转拽.";
    return;
  }

  const kidData = data.kid; 
  const kidId = kidData.id || ("kid_" + Date.now());

  //  ****** 砖转砖 砖专 砖专 注
  db.ref("kids/" + currentUserId + "/" + kidId).set(kidData)
    .then(() => {
      document.body.innerHTML = " 住祝 专住转 砖 爪!";
    });

});
</script>
